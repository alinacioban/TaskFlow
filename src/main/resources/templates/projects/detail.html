<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: base(
          ${project.name} + ' · TaskFlow',
          'projects',
          ~{::content}
      )}">

<th:block th:fragment="content">

  <!-- HEADER -->
  <div class="d-flex align-items-center justify-content-between mb-4">
      <div class="d-flex align-items-center gap-3">
          <img th:src="@{/img/LOGO_TASKFLOW.png}" alt="logo" width="32" class="rounded-3 shadow-sm">
          <h1 class="h4 mb-0 fw-bold" th:text="${project.name}">Nume proiect</h1>
      </div>

      <div class="d-flex gap-2">
          <a class="btn btn-outline-secondary" th:href="@{/projects}">
              <i class="bi bi-arrow-left me-1"></i> Înapoi
          </a>
          <a class="btn btn-primary" th:href="@{'/projects/' + ${project.id} + '/edit'}">
              <i class="bi bi-pencil me-1"></i> Editează
          </a>
      </div>
  </div>

  <!-- CONTENT CARD -->
  <div class="card shadow-sm border-0 p-4">

      <h2 class="h5 fw-bold mb-4">
          <i class="bi bi-info-circle me-2"></i> Detalii Proiect
      </h2>

      <div class="row g-4">

          <!-- LEFT COLUMN -->
          <div class="col-md-6">

              <!-- DESCRIPTION -->
              <div class="mb-4">
                  <label class="text-muted small fw-semibold">Descriere</label>
                  <p class="fs-6" th:text="${project.description ?: '—'}"></p>
              </div>

              <!-- CATEGORY -->
              <div class="mb-4">
                  <label class="text-muted small fw-semibold">Categorie</label>
                  <p class="fs-6" th:text="${project.category ?: '—'}"></p>
              </div>

              <!-- START DATE -->
              <div class="mb-4">
                  <label class="text-muted small fw-semibold">Data început</label>
                  <p class="fs-6"
                     th:text="${project.startDate != null ? #temporals.format(project.startDate, 'dd.MM.yyyy') : '—'}"></p>
              </div>

              <!-- PRIORITY -->
              <div class="mb-4">
                  <label class="text-muted small fw-semibold">Prioritate</label>
                  <p>
                      <span class="badge px-3 py-2"
                            th:classappend="${
                                project.priority.name() == 'CRITICAL' ? 'bg-danger' :
                                project.priority.name() == 'HIGH'     ? 'bg-warning text-dark' :
                                project.priority.name() == 'MEDIUM'   ? 'bg-info text-dark' :
                                                                        'bg-secondary'
                            }"
                            th:text="${project.priority}">
                      </span>
                  </p>
              </div>

              <!-- TECH STACK -->
              <div class="mb-4">
                  <label class="text-muted small fw-semibold">Tehnologii folosite</label>
                  <p class="fs-6" th:text="${project.techStack ?: '—'}"></p>
              </div>

              <!-- REPOSITORY -->
              <div class="mb-4">
                  <label class="text-muted small fw-semibold">Repository</label>
                  <p class="fs-6">
                      <a th:if="${project.repository != null}"
                         th:href="${project.repository}"
                         class="link-primary"
                         target="_blank"
                         th:text="${project.repository}"></a>
                      <span th:if="${project.repository == null}">—</span>
                  </p>
              </div>

          </div>

          <!-- RIGHT COLUMN -->
          <div class="col-md-6">

              <!-- EMPTY SPACER TOP -->
              <div class="mb-4 d-none d-md-block">&nbsp;</div>

              <!-- PROJECT MANAGER -->
              <div class="mb-4">
                  <label class="text-muted small fw-semibold">Manager Proiect</label>
                  <p class="fs-6 d-flex align-items-center gap-2">
                      <img th:src="@{/img/avatar.png}" width="32" class="rounded-circle border shadow-sm">
                      <span th:text="${project.lead ?: '—'}"></span>
                  </p>
              </div>

              <!-- END DATE -->
              <div class="mb-4">
                  <label class="text-muted small fw-semibold">Data final</label>
                  <p class="fs-6"
                     th:text="${project.endDate != null ? #temporals.format(project.endDate, 'dd.MM.yyyy') : '—'}"></p>
              </div>

              <!-- STATUS -->
              <div class="mb-4">
                  <label class="text-muted small fw-semibold">Status</label>
                  <p>
                      <span class="badge px-3 py-2"
                            th:classappend="${
                                project.status.name() == 'ACTIVE'   ? 'bg-success' :
                                project.status.name() == 'ON_HOLD' ? 'bg-warning text-dark' :
                                project.status.name() == 'DELAYED' ? 'bg-danger' :
                                                                     'bg-secondary'
                            }"
                            th:text="${project.status}">
                      </span>
                  </p>
              </div>

          </div>
      </div>
  </div>

  <!-- TASK LIST SECTION -->
  <div class="card mt-4 p-4 shadow-sm border-0">
      <div class="d-flex justify-content-between align-items-center mb-3">
          <h2 class="h5 fw-bold"><i class="bi bi-list-task me-2"></i> Task-uri</h2>

          <a class="btn btn-primary"
             th:href="@{'/projects/' + ${project.id} + '/tasks/new'}">
              <i class="bi bi-plus-lg me-1"></i> Adaugă Task
          </a>
      </div>

      <div th:if="${#lists.isEmpty(tasks)}" class="text-muted">
          Nu există task-uri în acest proiect.
      </div>

      <div class="list-group" th:each="t : ${tasks}">
          <div class="list-group-item d-flex justify-content-between align-items-center py-3">

              <div>
                  <h6 class="mb-1 fw-bold" th:text="${t.title}"></h6>
                  <small class="text-muted" th:text="'Status: ' + ${t.status}"></small>
              </div>

              <a class="btn btn-outline-secondary btn-sm"
                 th:href="@{'/tasks/' + ${t.id} + '/edit'}">
                  Editează
              </a>
          </div>
      </div>
  </div>

</th:block>
</html>